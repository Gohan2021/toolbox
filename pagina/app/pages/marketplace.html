<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Marketplace | TOOLBOX</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
   body {
  --s: 101px; /* control the size*/
  --c1: #b2b2b2df;
  --c2: #ffffff;
  --c3: #d9d9d9eb;
  
  --_g: var(--c3) 0 120deg,#0000 0;
  background:
    conic-gradient(from -60deg at 50% calc(100%/3),var(--_g)),
    conic-gradient(from 120deg at 50% calc(200%/3),var(--_g)),
    conic-gradient(from  60deg at calc(200%/3),var(--c3) 60deg,var(--c2) 0 120deg,#0000 0),
    conic-gradient(from 180deg at calc(100%/3),var(--c1) 60deg,var(--_g)),
    linear-gradient(90deg,var(--c1)   calc(100%/6),var(--c2) 0 50%,
                          var(--c1) 0 calc(500%/6),var(--c2) 0);
  background-size: calc(1.732*var(--s)) var(--s);
}

    header {
      background-color: #f8f9fa;
      border-bottom: 1px solid #ddd;
      padding: 1rem 2rem;
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
      position: sticky;
      top: 0;
      z-index: 1000;
    }

    .header-title {
      font-size: 1.5rem;
      font-weight: 700;
      color: #1a8754;
    }

    .header-search {
      flex-grow: 1;
      max-width: 500px;
      margin: 1rem;
    }
    .btn-outline-secondary:hover{
      background-color: #1a8754;
    }
    .btn-publicar {
      /* background-color: #ffc107; */
      font-weight: 600;
      color: #000;
      border: none;
    }

    .btn-publicar:hover {
      background-color: #ffb700;
    }

    .marketplace-card {
  border-radius: 0.8rem;
  transition: box-shadow 0.3s ease;
}

.marketplace-card:hover {
  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
}

.premium-badge {
  position: absolute;
  top: 0;
  left: 0;
  background-color: gold;
  color: #000;
  font-weight: bold;
  padding: 0.3rem 0.6rem;
  border-bottom-right-radius: 0.5rem;
}

    .product-img {
      height: 200px;
      object-fit: cover;
      width: 100%;
    }

    .alerta-materiales {
  background-color: #f8f9fa;
  border-left: 4px solid #ffc107;
  padding: 1rem;
  border-radius: 0.5rem;
}

    .container-market {
      padding: 2rem;
    }
  </style>
</head>
<body>
  <!-- header -->
  <header class="p-3 bg-white shadow-sm border-bottom">
    <div class="container-fluid">
      <div class="d-flex align-items-center gap-4 flex-wrap">
        <!-- üü¢ T√≠tulo -->
        <h1 class="fw-bold text-success fs-4 m-0 white-space-nowrap">
          üõ†Ô∏è <span class="text-warning">TOOLBOX</span> <br> Marketplace
        </h1>
  
        <!-- üîç Formulario de b√∫squeda -->
        <form class="d-flex flex-grow-1 gap-3 alerta-materiales" onsubmit="buscarMaterial(event)">
          <h6 class="fw-semibold mb-3">
            <i class="fas fa-bell text-warning"></i> ¬øQu√© Buscas?
          </h6>
          <input type="text" class="form-control" placeholder="Ej: Cemento, ladrillos...">
          <input type="text" class="form-control" placeholder="Ciudad o zona">
          <button class="btn btn-outline-secondary" type="submit">
            <img src="/imagenes/buscar.png" alt="Buscar" height="20">
          </button>
        </form>
  
        <!-- üü° Bot√≥n de publicar -->
        <div class="d-block">
          <a href="/publicar" class="btn btn-warning fw-semibold white-space-nowrap">
            <i class="fas fa-plus-circle me-1"></i> Publicar material
          </a>
          <a href="/notificaciones" class="btn btn-success fw-semibold white-space-nowrap">
            <i class="fas fa-plus-circle me-1"></i> Activar notificaciones
          </a>
        </div>
      </div>
    </div>
  </header>  
  <!-- üì¶ Contenido del Marketplace -->
  <div class="container container-market">
    <!-- Grid de productos -->
    <div class="row" id="productosContainer">
      <!-- Card de ejemplo -->
      <div class="col-md-4 mb-4">
        <div class="card marketplace-card position-relative">
          <span class="premium-badge bg-warning">PREMIUM</span>
          <img src="/imagenes/tools.jpg" alt="Producto" class="product-img">
          <div class="card-body">
            <h5 class="card-title">Ladrillos de obra (100 unidades)</h5>
            <p class="card-text text-muted">Ubicaci√≥n: Bogot√°</p>
            <p class="fw-bold text-success">$90.000</p>
            <div class="d-grid">
              <a href="https://wa.me/573001112233" target="_blank" class="btn btn-outline-success">
                <i class="fab fa-whatsapp"></i> Contactar
              </a>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-4 mb-4">
        <div class="card marketplace-card position-relative">
          <span class="premium-badge bg-warning">PREMIUM</span>
          <img src="/imagenes/tools.jpg" alt="Producto" class="product-img">
          <div class="card-body">
            <h5 class="card-title">Ladrillos de obra (100 unidades)</h5>
            <p class="card-text text-muted">Ubicaci√≥n: Bogot√°</p>
            <p class="fw-bold text-success">$90.000</p>
            <div class="d-grid">
              <a href="https://wa.me/573001112233" target="_blank" class="btn btn-outline-success">
                <i class="fab fa-whatsapp"></i> Contactar
              </a>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-4 mb-4">
        <div class="card marketplace-card position-relative">
          <span class="premium-badge bg-warning">PREMIUM</span>
          <img src="/imagenes/tools.jpg" alt="Producto" class="product-img">
          <div class="card-body">
            <h5 class="card-title">Ladrillos de obra (100 unidades)</h5>
            <p class="card-text text-muted">Ubicaci√≥n: Bogot√°</p>
            <p class="fw-bold text-success">$90.000</p>
            <div class="d-grid">
              <a href="https://wa.me/573001112233" target="_blank" class="btn btn-outline-success">
                <i class="fab fa-whatsapp"></i> Contactar
              </a>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-4 mb-4">
        <div class="card marketplace-card position-relative">
          <span class="premium-badge bg-warning">PREMIUM</span>
          <img src="/imagenes/tools.jpg" alt="Producto" class="product-img">
          <div class="card-body">
            <h5 class="card-title">Ladrillos de obra (100 unidades)</h5>
            <p class="card-text text-muted">Ubicaci√≥n: Bogot√°</p>
            <p class="fw-bold text-success">$90.000</p>
            <div class="d-grid">
              <a href="https://wa.me/573001112233" target="_blank" class="btn btn-outline-success">
                <i class="fab fa-whatsapp"></i> Contactar
              </a>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-4 mb-4">
        <div class="card marketplace-card position-relative">
          <span class="premium-badge bg-warning">PREMIUM</span>
          <img src="/imagenes/tools.jpg" alt="Producto" class="product-img">
          <div class="card-body">
            <h5 class="card-title">Ladrillos de obra (100 unidades)</h5>
            <p class="card-text text-muted">Ubicaci√≥n: Bogot√°</p>
            <p class="fw-bold text-success">$90.000</p>
            <div class="d-grid">
              <a href="https://wa.me/573001112233" target="_blank" class="btn btn-outline-success">
                <i class="fab fa-whatsapp"></i> Contactar
              </a>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-4 mb-4">
        <div class="card marketplace-card position-relative">
          <span class="premium-badge bg-warning">PREMIUM</span>
          <img src="/imagenes/tools.jpg" alt="Producto" class="product-img">
          <div class="card-body">
            <h5 class="card-title">Ladrillos de obra (100 unidades)</h5>
            <p class="card-text text-muted">Ubicaci√≥n: Bogot√°</p>
            <p class="fw-bold text-success">$90.000</p>
            <div class="d-grid">
              <a href="https://wa.me/573001112233" target="_blank" class="btn btn-outline-success">
                <i class="fab fa-whatsapp"></i> Contactar
              </a>
            </div>
          </div>
        </div>
      </div>
      <!-- Fin ejemplo -->
    </div>
  </div>

  <script>
    function buscarMaterial(e) {
      e.preventDefault();
      const query = document.getElementById("buscarInput").value.trim();
      if (query) {
        alert("üîç Buscar: " + query);
        // Aqu√≠ puedes implementar b√∫squeda real
      }
    }
  </script>
  <script src="https://kit.fontawesome.com/a2c3f9c9c4.js" crossorigin="anonymous"></script>
  <script>
  async function cargarMarketplace() {
  const contenedor = document.getElementById("productosContainer");

  try {
    const res = await fetch("http://localhost:4000/api/marketplace/publicaciones");
    const data = await res.json();

    if (!data.publicaciones || data.publicaciones.length === 0) {
      contenedor.innerHTML = "<p class='text-muted'>No hay publicaciones disponibles.</p>";
      return;
    }

    contenedor.innerHTML = "";

    data.publicaciones.forEach(pub => {
      const card = document.createElement("div");
      card.className = "col-md-4 mb-4";

      card.innerHTML = `
        <div class="card marketplace-card position-relative">
          ${pub.destacado ? `<span class="premium-badge bg-warning">PREMIUM</span>` : ""}
          <img src="${pub.ruta_imagen || '/imagenes/default-material.jpg'}" class="product-img" alt="${pub.titulo}">
          <div class="card-body">
            <h5 class="card-title">${pub.titulo}</h5>
            <p class="card-text text-muted">${pub.ubicacion || 'Ubicaci√≥n no especificada'}</p>
            <p class="fw-bold text-success">$${parseFloat(pub.precio).toLocaleString()}</p>
            <div class="d-grid">
              <a href="https://wa.me/573001112233" target="_blank" class="btn btn-outline-success">
                <i class="fab fa-whatsapp"></i> Contactar
              </a>
            </div>
          </div>
        </div>
      `;

      contenedor.appendChild(card);
    });
  } catch (error) {
    console.error("‚ùå Error al cargar el marketplace:", error);
    contenedor.innerHTML = "<p class='text-danger'>Error al cargar los productos.</p>";
  }
}

document.addEventListener("DOMContentLoaded", cargarMarketplace);
  </script>
</body>
</html>
